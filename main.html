<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>laaaaa</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style >
            @import "main.css";

             div div{
                display: inline;
            }
             div div div{
                position: absolute;
                z-index: 60;
            }
        </style>
        <script src="img_process.js"></script>
</head>
<body>

    <img  class="blank"  src="img_source\blank.png">
    <img  id="wood" src="img_source\bg\wood.png" >
    <img id="xp" src="xp.png">

    

    <div class="special" id="spp">
        <div>   
            <div id="sp_0">
                <img class="sp" id="sp0" src="img_source\food\special\8.png">
                <img class="sp" id="sp1" src="img_source\food\special\8.png">
                <img class="sp" id="sp2" src="img_source\food\special\8.png">
            </div>
            <img    class="box" src="img_source\bg\box.png">
        </div>
        <div>    
            
            <div id="sp_1">
                <img class="sp" id="sp3" src="img_source\food\special\0.png">
                <img class="sp" id="sp4" src="img_source\food\special\0.png">
                <img class="sp" id="sp5" src="img_source\food\special\0.png">
            </div>
            <img    class="box" src="img_source\bg\box.png">
        </div>
    </div>

    <div  class="special" id="egg_box">
    <div>
            <div class="food" id="egg_0">
                <img class="sp" id="egg0" src="img_source\food\fresh\3egg.png">
                <img class="sp" id="egg1" src="img_source\food\fresh\3egg.png">
                <img class="sp" id="egg2" src="img_source\food\fresh\3egg.png">
                <img class="sp" id="egg3" src="img_source\food\fresh\3egg.png">
                <img class="sp" id="egg4" src="img_source\food\fresh\3egg.png">

            </div>
            <img  class="blank"  src="img_source\blank.png">
    </div>   
</div>
    <div  class="special" id="tomato">
        <div>
            <img src="img_source\bg\blanket_o.png" class="tom_blanket"id="tom_blanket">
                <div class="food" id="tom_0">
                    <img class="sp" id="tom0" src="img_source\food\fresh\4tomato.png">
                    <img class="sp" id="tom1" src="img_source\food\fresh\4tomato.png">
                    <img class="sp" id="tom2" src="img_source\food\fresh\4tomato.png">
                    <img class="sp" id="tom3" src="img_source\food\fresh\4tomato.png">
                    <img class="sp" id="tom4" src="img_source\food\fresh\4tomato.png">
    
                </div>
                <img src="img_source\bg\blanket.png" class="tom_blanket" >
                <img  class="blank" id="tomb" src="img_source\blank.png">
                
        </div>
    </div>   
    <div  class="special" id="noodle">
        <div>
                <div class="food" id="tom_0">
                    <img class="sp" id="noodle0" src="img_source\food\fresh\3noodle.png">
                    <img class="sp" id="noodle1" src="img_source\food\fresh\3noodle.png">
                    <img class="sp" id="noodle2" src="img_source\food\fresh\3noodle.png">
                    <img class="sp" id="noodle3" src="img_source\food\fresh\3noodle.png">
    
                </div>
                <img  class="blank"  src="img_source\blank.png">
                
        </div>
    </div>  
    


    <div id="guest0" class="guest_0">
        
        <div id="0" class="g">
            <img  class="head_img"  src="uuu.png">
            <img  class="guest"  src="img_source\guest.png">
        </div>
        
    </div>
    <div id="guest1" class="guest_0">
        <div id="1" class="g">
            
            <img  class="guest"  src="img_source\guest.png">
        </div>
        
    </div>
    <div id="guest2" class="guest_0">

        <div id="2" class="g">
            
            <img  class="guest"  src="img_source\guest.png">
        </div>
        
    </div>
    <img  id="sky" class="sky" src="img_source\sky.jpg" >


<script >
    let wid=window.innerWidth;
    img_resize();
    $(document).ready(function(){

        $(function () {
            var _link = $('<link rel="stylesheet" type="text/css" href="https://vayne1125.github.io/final_project/CSS.css">');
            
            // 提前修改link屬性
            _link.attr("title", "global");
            
            _link.appendTo("head");
        });
        for(let i=0;i<2;i++)$("#guest"+i).animate({top:"+=600px"},10);
        let ds=document.querySelectorAll(".sp"),dr=document.querySelectorAll(".g"); //砸食材
    [].forEach.call(ds,function(ds){
        ds.ondragstart=function(event){
            event.dataTransfer.setData("text", event.target.id);
        };
        
    });
    [].forEach.call(dr,function(drr){
        drr.ondrop=function(event){
            event.preventDefault();
            let data = event.dataTransfer.getData("text");
            let tar=document.querySelector('#'+data);
                let d=tar.src.split('/');
                let wast=document.createElement("img");
                wast.src="img_source\\food\\wasted\\"+d[d.length-1];wast.className="wasted";wast.draggable=false;
                wast.style.width=""+wid/6+"px";
                $(document).ready(function(){
                    $(event.target.parentNode).prepend(wast);
                    $(wast).css("top",""+(parseInt($('#guest'+wast.parentNode.id).css("top"))-200)+"px");//待調整
                    console.log(parseInt($('#guest'+wast.parentNode.id).css("top")));
                    $(tar).hide();
                });
        
    }});
            for(let i=0,pos,speed;i<1000;i++){                     //guest移動
                pos=Math.floor(Math.random()*(wid/6*3))+wid/6;
                speed=((Math.floor(Math.random()*7))+3)*100;
                $("#guest0").animate({left:""+pos+"px"},100);
                $("#guest0").animate({top:"-=600px"},speed);
                $("#guest0").animate({top:"+=600px"},speed);
        
        }
        
        $(".sky").bind("drop",function(e){     //miss!!!
            e.preventDefault();
            let ev=e.originalEvent.dataTransfer.getData("text");
            let t=document.querySelector('#'+ev);
            $(t).hide();
            console.log(ev);
        });

    });

</script>
</body>

</html>
